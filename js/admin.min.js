$(function(){function j(a,b){return $(document.createElement("li")).append($(document.createElement("span")).addClass("chars-left").append(250-a.children(b).val().length))}function i(b){return a($(document.createElement("textarea")),b)}function h(b){return a($(document.createElement("input")).attr("type","text"))}function a(a,b){if(b===undefined)b=a;return a.blur(function(){$(this).val($(this).val().trim().replace(/\s{2,}/," "))}).bind("keyup blur",function(a){var c=250-$(this).val().length;b.contents().find(".chars-left").text(c)})}a($("#post-title, #post-tags, #post-description, #post-directory"));$(".edit-title, .edit-tags, .delete-post").hide();$(".post-title").mouseover(function(){$(this).contents(".edit-title").show()}).mouseout(function(){$(this).contents(".edit-title").hide()});$(".post-tags").mouseover(function(){$(this).contents(".edit-tags").show()}).mouseout(function(){$(this).contents(".edit-tags").hide()});var b="A bad request was made. Either your input is too long or the directory could not be found.";var c="For some reason, the post you are editing could not be found.";var d="There was a problem with the database when editing your post. Try again.";var e=$(document.createElement("a")).append("submit").attr("title","submit").attr("href","javascript: void(0)").button({text:false,icons:{primary:"ui-icon-check"}});var f=$(document.createElement("a")).append("cancel").attr("title","cancel").attr("href","javascript: void(0)").button({text:false,icons:{primary:"ui-icon-closethick"}});var g=$(document.createElement("li")).append($(document.createElement("img")).attr("src",BASE_URL+"images/spinner.gif").attr("alt","loading")).hide();$("div.post-title a.edit-title").click(function(){var a=$(this).parent();var i=a.children(".post-title").text();var k=a.contents().clone(true);var l=a.attr("id").replace(/[a-z\-]/g,"");editor=h(a).attr("class","post-title-input").attr("value",i);a.empty().append(editor);var m=j(a,"input");var n=$(document.createElement("li")).append(e.clone(true).click(function(){a.contents().find(".post-title-spinner").show();var e=a.children("input").val().trim().replace(/\s{2,}/," ");if(e.length>0&&e.length<=250&&e!=i){$.ajax({dataType:"json",url:BASE_URL+"admin/update/title/"+l,type:"POST",data:{title:e},statusCode:{400:function(){alert(b)},404:function(){alert(c)},500:function(){alert(d)}},success:function(b){a.contents().find(".post-title-spinner").hide();if(b.error===undefined){var c=k;var d=0;$(c[d]).children("a").text(b.title);a.empty().append(c)}else{alert(b.error)}}})}else{a.empty().append(k)}}));var o=$(document.createElement("li")).append(f.clone(true).click(function(){a.empty().append(k)}));var p=g.clone(true).attr("class","post-title-spinner");var q=$(document.createElement("ul")).attr("class","post-title-commander").append(m).append(n).append(o).append(p);a.append(q)});$("div.post-row div.post-tags a.edit-tags").click(function(){var a=$(this).parent();var i="";a.find(".tags-list").children("li").each(function(){i+=" "+$(this).text()});i=i.replace(/^\s+/,"");var k=a.contents().clone(true);var l=a.attr("id").replace(/[a-z\-]/g,"");var m=h(a).attr("class","post-tags-input").attr("value",i);a.empty().append($(document.createElement("strong")).append("tagged")).append(" ").append(m);var n=j(a,"input");var o=$(document.createElement("li")).append(e.clone(true).click(function(){a.contents().find(".post-tags-spinner").show();var e=a.children("input").val().trim().replace(/\s{2,}/," ");if(e!=""&&e!=i&&e.length<=250){$.ajax({dataType:"json",url:BASE_URL+"admin/update/tags/"+l,type:"POST",data:{tags:e},statusCode:{400:function(){alert(b)},404:function(){alert(c)},500:function(){alert(d)}},success:function(b){a.contents().find(".post-tags-spinner").hide();if(b.error===undefined){var c=k;var d=2;$(c[d]).empty();var e=b.tags.split(" ");for(var f=0;f<e.length;f++){var g=$(document.createElement("li")).append($(document.createElement("a")).attr("href",BASE_URL+"search-tags/"+e[f]).attr("target","_blank").append(e[f]));if(f==e.length-1){g.addClass("last")}$(c[d]).append(g)}a.empty().append(c)}else{alert(b.error)}}})}else{a.empty().append(k)}}));var p=$(document.createElement("li")).append(f.clone(true).click(function(){a.empty().append(k)}));var q=g.clone(true).attr("class","post-tags-spinner");var r=$(document.createElement("ul")).attr("class","post-tags-commander").append(n).append(o).append(p).append(q);a.append(r)});$("div.post-row div.post-description p").click(function(){var a=$(this).parent();var e=$(this).text();var h=a.contents().clone(true);var k=a.attr("id").replace(/[a-z\-]/g,"");var l=i(a).attr("class","post-description-textarea").append(e);a.empty().append(l);var m=j(a,"textarea");var n=$(document.createElement("li")).append($(document.createElement("a")).append("submit").attr("title","submit").attr("href","javascript: void(0)").button({text:false,icons:{primary:"ui-icon-check"}}).click(function(){a.contents().find(".post-description-spinner").show();var f=a.children("textarea").val().trim().replace(/\s{2,}/," ");if(f.length>0&&f.length<=250&&f!=e){$.ajax({dataType:"json",url:BASE_URL+"admin/update/description/"+k,type:"POST",data:{description:f},statusCode:{400:function(){alert(b)},404:function(){alert(c)},500:function(){alert(d)}},success:function(b){a.contents().find(".post-description-spinner").hide();if(b.error===undefined){var c=h;var d=0;$(c[d]).text(b.description);a.empty().append(c)}else{alert(b.error)}}})}else{a.empty().append(h)}}));var o=$(document.createElement("li")).append(f.clone(true).click(function(){a.empty().append(h)}));var p=g.clone(true).attr("class","post-description-spinner");var q=$(document.createElement("ul")).attr("class","post-description-commander").append(m).append(n).append(o).append(p);a.append(q)});$("div.post-row div.post-meta ul li.post-path .post-directory").click(function(){var a=$(this).parent();var i=$(this).text();var k=a.contents().clone(true);var l=$(this).attr("id").replace(/[a-z\-]/g,"");var m=h(a).attr("class","post-directory-input").attr("value",i);a.children(".post-directory").remove();a.append(m);var n=j(a,"input");var o=$(document.createElement("li")).append(e.clone(true).click(function(){a.contents().find(".post-directory-spinner").show();var e=a.children("input").val().trim().replace(/\s{2,}/," ");if(e.length>0&&e.length<=250&&e!=i){$.ajax({dataType:"json",url:BASE_URL+"admin/update/directory/"+l,type:"POST",data:{directory:e},statusCode:{400:function(){alert(b)},404:function(){alert(c)},500:function(){alert(d)}},success:function(b){a.contents().find(".post-directory-spinner").hide();if(b.error===undefined){var c=k;var d=2;$(c[d]).text(e);a.empty().append(c)}else{alert(b.error)}}})}else{a.empty().append(k)}}));var p=$(document.createElement("li")).append(f.clone(true).click(function(){a.empty().append(k)}));var q=g.clone(true).attr("class","post-directory-spinner");var r=$(document.createElement("ul")).attr("class","post-directory-commander").append(n).append(o).append(p).append(q);a.append(r)})})